import{T as C,r as h,x as k,o as a,s as S,e as T,d as B,u as i,Z as N,f as e,m as A,b as n,t as p,j as c,i as D,p as M,F as V,h as E,v as F,k as I,y as f}from"./app-a2ecb7c5.js";import{_ as Y}from"./AuthenticatedLayout-9d0ec931.js";import{S as g}from"./sweetalert2.esm.all-509645c6.js";import"./ApplicationLogo-7c7b58d1.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./ResponsiveNavLink-642b6481.js";const L={class:"py-12"},$={class:"max-w-8xl mx-auto sm:px-8 lg:px-12"},j={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},q={class:"p-8"},z={class:"text-3xl font-semibold mb-6"},H={key:0,class:"ml-2 bg-red-500 text-white text-sm px-2 py-1 rounded-full"},O={key:0,class:"text-center py-10"},U=e("h3",{class:"text-xl font-medium text-gray-900 mb-4"},"Welcome to Chat Support",-1),W=e("p",{class:"text-gray-600 mb-6"},"Our support team is here to help you. Start a conversation with us!",-1),Z={class:"whitespace-pre-wrap"},G={class:"text-xs text-gray-500 block mt-1"},J=["onClick"],K=["disabled"],oe={__name:"Index",props:{chats:Array,unreadCount:Number,hasActiveChat:Boolean},setup(r){const x=r,o=C({message:""}),u=h(null),l=h(x.hasActiveChat),d=h(!1),b=()=>{u.value&&(u.value.scrollTop=u.value.scrollHeight)},v=()=>{l.value=!0,f(()=>{const s=document.querySelector('input[name="message"]');s&&s.focus()})},y=()=>{!o.message.trim()||d.value||(d.value=!0,o.post(route("chat.store"),{onSuccess:()=>{o.reset(),l.value=!0,f(()=>{b()})},onFinish:()=>{d.value=!1}}))},w=()=>{axios.get(route("chat.index")).then(s=>{x.chats=s.data.chats}).catch(s=>{console.error("Error fetching chats:",s)})},_=s=>{g.fire({title:"Are you sure?",text:"You won't be able to undo this action!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!"}).then(m=>{m.isConfirmed&&axios.delete(route("chat.destroy",{id:s})).then(t=>{w(),g.fire("Deleted!","Your message has been deleted.","success"),window.location.reload()}).catch(t=>{console.error("Error deleting message:",t),g.fire("Error!","There was a problem deleting the message.","error")})})};return k(()=>{b()}),(s,m)=>(a(),S(Y,null,{default:T(()=>[B(i(N),{title:"Chat Support"}),e("div",L,[e("div",$,[e("div",j,[e("div",q,[e("h2",z,[A(" Chat Support "),r.unreadCount>0?(a(),n("span",H,p(r.unreadCount)+" new ",1)):c("",!0)]),e("div",{ref_key:"chatContainer",ref:u,class:"space-y-6 mb-4 h-[calc(85vh-200px)] overflow-y-auto p-6 bg-gray-50 rounded-lg"},[!r.hasActiveChat&&!l.value?(a(),n("div",O,[U,W,e("button",{onClick:v,class:"px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"}," Start New Conversation ")])):c("",!0),r.hasActiveChat||l.value?(a(!0),n(V,{key:1},D(r.chats,t=>(a(),n("div",{key:t.id,class:M(["p-4 rounded-lg max-w-[50%]",t.is_admin?"bg-blue-100":"ml-auto bg-white border border-gray-200"])},[e("p",Z,p(t.message),1),e("span",G,p(new Date(t.created_at).toLocaleString()),1),t.is_admin?c("",!0):(a(),n("button",{key:0,onClick:P=>_(t.id),class:"text-red-500 text-sm mt-2"}," Delete ",8,J))],2))),128)):c("",!0)],512),l.value?(a(),n("form",{key:0,onSubmit:I(y,["prevent"]),class:"flex gap-2"},[E(e("input",{"onUpdate:modelValue":m[0]||(m[0]=t=>i(o).message=t),type:"text",name:"message",placeholder:"Type your message...",class:"flex-1 rounded-lg border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200"},null,512),[[F,i(o).message]]),e("button",{type:"submit",class:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50",disabled:i(o).processing||!i(o).message.trim()||d.value}," Send ",8,K)],32)):c("",!0)])])])])]),_:1}))}};export{oe as default};
